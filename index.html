<!DOCTYPE html>
<html lang="ta">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Lab Dashboard</title>
    <style>
        :root { --primary: #1a73e8; --secondary: #5f6368; --bg: #f8f9fa; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--bg); margin: 0; padding: 20px; }
        .container { max-width: 1100px; margin: 0 auto; text-align: center; }
        
        h1 { color: var(--primary); margin-bottom: 10px; }
        .subtitle { color: var(--secondary); margin-bottom: 40px; }

        /* DASHBOARD GRID */
        #dashboard { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 25px; margin-top: 20px; }
        .card { background: white; padding: 40px 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); cursor: pointer; transition: 0.3s; border-bottom: 5px solid var(--primary); }
        .card:hover { transform: translateY(-10px); box-shadow: 0 8px 25px rgba(0,0,0,0.15); }
        .card h2 { color: #333; margin-bottom: 10px; }
        .card p { color: #666; font-size: 14px; }

        /* EXERCISE CONTENT */
        .exercise-view { display: none; animation: fadeIn 0.4s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .back-btn { background: #6c757d; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; float: left; margin-bottom: 20px; }
        
        .grid-content { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 20px; clear: both; }
        .box { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); text-align: left; }
        h3 { border-bottom: 2px solid #eee; padding-bottom: 10px; color: var(--primary); }
        
        input { width: 100%; padding: 10px; margin: 8px 0; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; }
        .btn-group { display: flex; gap: 10px; margin-top: 10px; }
        button { flex: 1; padding: 12px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-success { background: #28a745; color: white; }
        .btn-danger { background: #dc3545; color: white; }
        
        .result { margin-top: 15px; padding: 12px; background: #f1f3f4; border-radius: 6px; font-family: monospace; word-break: break-all; min-height: 20px; }
    </style>
</head>
<body>

<div class="container">
    
    <!-- MAIN DASHBOARD -->
    <div id="main-dashboard">
        <h1>Cryptography Laboratory</h1>
        <p class="subtitle">Select an exercise to explore the algorithms</p>
        
        <div id="dashboard">
            <div class="card" onclick="openExercise(1)">
                <h2>Exercise 1</h2>
                <p>Classical Ciphers: Vigenere & Affine</p>
            </div>
            <div class="card" onclick="openExercise(2)">
                <h2>Exercise 2</h2>
                <p>Substitution: Playfair Cipher</p>
            </div>
            <div class="card" onclick="openExercise(3)">
                <h2>Exercise 3</h2>
                <p>Number Theory: Prime & GCD</p>
            </div>
        </div>
    </div>

    <!-- EXERCISE 1 VIEW -->
    <div id="view-1" class="exercise-view">
        <button class="back-btn" onclick="goHome()">← Back to Dashboard</button>
        <div class="grid-content">
            <div class="box">
                <h3>Vigenere Cipher</h3>
                <input type="text" id="vigT" placeholder="Plaintext">
                <input type="text" id="vigK" placeholder="Key">
                <div class="btn-group">
                    <button class="btn-success" onclick="vigenere(true)">Encrypt</button>
                    <button class="btn-danger" onclick="vigenere(false)">Decrypt</button>
                </div>
                <div id="vigR" class="result"></div>
            </div>
            <div class="box">
                <h3>Affine Cipher</h3>
                <input type="text" id="affT" placeholder="Plaintext">
                <input type="number" id="affA" placeholder="Key a (e.g. 5)">
                <input type="number" id="affB" placeholder="Key b (e.g. 8)">
                <div class="btn-group">
                    <button class="btn-success" onclick="affine(true)">Encrypt</button>
                    <button class="btn-danger" onclick="affine(false)">Decrypt</button>
                </div>
                <div id="affR" class="result"></div>
            </div>
        </div>
    </div>

    <!-- EXERCISE 2 VIEW -->
    <div id="view-2" class="exercise-view">
        <button class="back-btn" onclick="goHome()">← Back to Dashboard</button>
        <div class="grid-content">
            <div class="box" style="grid-column: 1 / -1;">
                <h3>Playfair Cipher</h3>
                <input type="text" id="pfT" placeholder="Enter text">
                <input type="text" id="pfK" placeholder="Enter key">
                <div class="btn-group">
                    <button class="btn-success" onclick="playfair(true)">Encrypt</button>
                    <button class="btn-danger" onclick="playfair(false)">Decrypt</button>
                </div>
                <div id="pfR" class="result"></div>
            </div>
        </div>
    </div>

    <!-- EXERCISE 3 VIEW -->
    <div id="view-3" class="exercise-view">
        <button class="back-btn" onclick="goHome()">← Back to Dashboard</button>
        <div class="grid-content">
            <div class="box">
                <h3>Miller-Rabin</h3>
                <input type="number" id="mrI" placeholder="Number to test">
                <button class="btn-primary" onclick="runMR()">Check Prime</button>
                <div id="mrR" class="result"></div>
            </div>
            <div class="box">
                <h3>Euclidean GCD</h3>
                <input type="number" id="gA" placeholder="Number A">
                <input type="number" id="gB" placeholder="Number B">
                <button class="btn-primary" onclick="runGCD()">Find GCD</button>
                <div id="gR" class="result"></div>
            </div>
            <div class="box">
                <h3>Fermat Theorem</h3>
                <input type="number" id="fA" placeholder="Base a">
                <input type="number" id="fP" placeholder="Prime p">
                <button class="btn-primary" onclick="runFermat()">Verify</button>
                <div id="fR" class="result"></div>
            </div>
        </div>
    </div>

</div>

<script>
    // --- Navigation Logic ---
    function openExercise(num) {
        document.getElementById('main-dashboard').style.display = 'none';
        document.querySelectorAll('.exercise-view').forEach(v => v.style.display = 'none');
        document.getElementById('view-' + num).style.display = 'block';
    }

    function goHome() {
        document.getElementById('main-dashboard').style.display = 'block';
        document.querySelectorAll('.exercise-view').forEach(v => v.style.display = 'none');
    }

    // --- Core Algorithms ---
    function vigenere(e){
        let t=document.getElementById('vigT').value.toUpperCase().replace(/[^A-Z]/g,''),
            k=document.getElementById('vigK').value.toUpperCase().replace(/[^A-Z]/g,''),r="";
        for(let i=0,j=0;i<t.length;i++){
            let c=t.charCodeAt(i)-65, key=k.charCodeAt(j%k.length)-65;
            r+=String.fromCharCode(e?(c+key)%26+65:(c-key+26)%26+65); j++;
        }
        document.getElementById('vigR').innerText=r;
    }

    function affine(e){
        let t=document.getElementById('affT').value.toUpperCase().replace(/[^A-Z]/g,''),
            a=parseInt(document.getElementById('affA').value), b=parseInt(document.getElementById('affB').value), r="", inv=0;
        for(let i=0;i<26;i++) if((a*i)%26==1) inv=i;
        for(let i=0;i<t.length;i++){
            let x=t.charCodeAt(i)-65;
            r+=String.fromCharCode(e?(a*x+b)%26+65:(inv*(x-b+26))%26+65);
        }
        document.getElementById('affR').innerText=r;
    }

    function playfair(e){
        let k=document.getElementById('pfK').value.toUpperCase().replace(/J/g,'I').replace(/[^A-Z]/g,''),
            t=document.getElementById('pfT').value.toUpperCase().replace(/J/g,'I').replace(/[^A-Z]/g,''),
            m=[], alpha="ABCDEFGHIKLMNOPQRSTUVWXYZ", set=new Set(k+alpha), fKey=Array.from(set);
        while(fKey.length) m.push(fKey.splice(0,5));
        let prep=""; for(let i=0;i<t.length;i++){ prep+=t[i]; if(e && t[i]===t[i+1]) prep+='X'; }
        if(prep.length%2!==0) prep+='X';
        let res="";
        for(let i=0; i<prep.length; i+=2){
            let a=prep[i], b=prep[i+1], r1,c1,r2,c2;
            for(let r=0;r<5;r++) for(let c=0;c<5;c++) { if(m[r][c]===a){r1=r;c1=c} if(m[r][c]===b){r2=r;c2=c} }
            if(r1===r2) res+=m[r1][(c1+(e?1:4))%5]+m[r2][(c2+(e?1:4))%5];
            else if(c1===c2) res+=m[(r1+(e?1:4))%5][c1]+m[(r2+(e?1:4))%5][c2];
            else res+=m[r1][c2]+m[r2][c1];
        }
        document.getElementById('pfR').innerText=res;
    }

    function expMod(b,e,m){
        let r=1n; b=BigInt(b)%BigInt(m); e=BigInt(e);
        while(e>0n){ if(e%2n===1n) r=(r*b)%BigInt(m); b=(b*b)%BigInt(m); e/=2n; }
        return r;
    }
    function runMR(){
        let n=BigInt(document.getElementById('mrI').value||0);
        if(n<2n){document.getElementById('mrR').innerText="No"; return;}
        let d=n-1n; while(d%2n===0n) d/=2n;
        let x=expMod(2n,d,n);
        document.getElementById('mrR').innerText=(x===1n||x===n-1n)?"Probably Prime":"Composite";
    }
    function runGCD(){
        let a=BigInt(document.getElementById('gA').value||0), b=BigInt(document.getElementById('gB').value||0);
        while(b!==0n){let t=b; b=a%b; a=t;}
        document.getElementById('gR').innerText="GCD: "+a;
    }
    function runFermat(){
        let a=BigInt(document.getElementById('fA').value), p=BigInt(document.getElementById('fP').value);
        let r=expMod(a,p-1n,p);
        document.getElementById('fR').innerText=r===1n?"✅ Verified (1)":"❌ Failed ("+r+")";
    }
</script>

</body>
</html>
