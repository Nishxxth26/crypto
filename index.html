<!DOCTYPE html>
<html lang="ta">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neon Crypto Lab - Final</title>
    <link href="https://fonts.googleapis.com" rel="stylesheet">
    <style>
        :root {
            --glass: rgba(255, 255, 255, 0.05);
            --border: rgba(255, 255, 255, 0.1);
            --neon: #00f2fe;
            --neon-pink: #e73c7e;
        }

        body {
            margin: 0;
            overflow-x: hidden;
            font-family: 'Poppins', sans-serif;
            background: #090a0f;
            color: white;
            min-height: 100vh;
        }

        /* Particles Background */
        .background {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1;
            background: radial-gradient(circle at 50% 50%, #1b2735 0%, #090a0f 100%);
        }

        .particle {
            position: absolute;
            background: rgba(0, 242, 254, 0.3);
            border-radius: 50%;
            pointer-events: none;
            animation: float 15s infinite linear;
        }

        @keyframes float {
            0% { transform: translateY(100vh) scale(0); opacity: 0; }
            50% { opacity: 1.8; }
            100% { transform: translateY(-10vh) scale(1.2); opacity: 0; }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
            text-align: center;
        }

        h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: clamp(1.5rem, 5vw, 3rem);
            letter-spacing: 5px;
            background: linear-gradient(to right, #fff, var(--neon));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 40px;
        }

        /* Dashboard Cards */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
        }

        .card {
            background: var(--glass);
            backdrop-filter: blur(15px);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 30px;
            cursor: pointer;
            transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .card:hover {
            transform: translateY(-10px);
            border-color: var(--neon);
            box-shadow: 0 0 20px rgba(0, 242, 254, 0.3);
            background: rgba(255, 255, 255, 0.1);
        }

        .card h2 { font-family: 'Orbitron', sans-serif; color: var(--neon); margin: 0 0 10px 0; }

        /* Exercise Content Area */
        .exercise-view {
            display: none;
            animation: fadeIn 0.6s ease;
        }

        @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }

        .back-btn {
            background: transparent;
            border: 1px solid var(--neon-pink);
            color: var(--neon-pink);
            padding: 10px 25px;
            border-radius: 50px;
            cursor: pointer;
            font-family: 'Orbitron', sans-serif;
            margin-bottom: 30px;
            transition: 0.3s;
        }

        .back-btn:hover { background: var(--neon-pink); color: white; box-shadow: 0 0 15px var(--neon-pink); }

        .algo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
        }

        .algo-box {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border);
            padding: 25px;
            border-radius: 15px;
            text-align: left;
        }

        input {
            width: 100%;
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border);
            padding: 12px;
            border-radius: 8px;
            color: white;
            margin: 8px 0;
            outline: none;
        }

        input:focus { border-color: var(--neon); }

        .action-btn {
            width: 100%;
            background: linear-gradient(45deg, var(--neon), #4facfe);
            border: none;
            padding: 12px;
            border-radius: 8px;
            color: #000;
            font-weight: bold;
            font-family: 'Orbitron', sans-serif;
            cursor: pointer;
            margin-top: 10px;
        }

        .result {
            margin-top: 15px;
            padding: 15px;
            background: rgba(0,0,0,0.4);
            border-radius: 8px;
            border-left: 4px solid var(--neon);
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            min-height: 20px;
        }
    </style>
</head>
<body>

    <div class="background" id="bg-particles"></div>

    <div class="container">
        <!-- HEADER -->
        <div id="home-view">
            <h1>NEON CRYPTO LAB</h1>
            <div class="dashboard-grid">
                <div class="card" onclick="showEx(1)">
                    <h2>EX 01</h2>
                    <p>Vigenere & Affine Ciphers</p>
                </div>
                <div class="card" onclick="showEx(2)">
                    <h2>EX 02</h2>
                    <p>Playfair Substitution</p>
                </div>
                <div class="card" onclick="showEx(3)">
                    <h2>EX 03</h2>
                    <p>Number Theory Lab</p>
                </div>
            </div>
        </div>

        <!-- EXERCISE CONTAINER -->
        <div id="ex-container" class="exercise-view">
            <button class="back-btn" onclick="showHome()">← BACK TO DASHBOARD</button>
            <div id="ex-content" class="algo-grid"></div>
        </div>
    </div>

    <script>
        // Background Particles Logic
        const bg = document.getElementById('bg-particles');
        for (let i = 0; i < 40; i++) {
            const p = document.createElement('div');
            p.className = 'particle';
            p.style.width = Math.random() * 4 + 'px';
            p.style.height = p.style.width;
            p.style.left = Math.random() * 100 + 'vw';
            p.style.animationDuration = (Math.random() * 8 + 7) + 's';
            p.style.animationDelay = Math.random() * 5 + 's';
            bg.appendChild(p);
        }

        function showEx(n) {
            document.getElementById('home-view').style.display = 'none';
            const container = document.getElementById('ex-container');
            const content = document.getElementById('ex-content');
            container.style.display = 'block';

            if(n === 1) {
                content.innerHTML = `
                    <div class="algo-box">
                        <h3>Vigenere Cipher</h3>
                        <input id="vT" placeholder="Plaintext">
                        <input id="vK" placeholder="Key">
                        <button class="action-btn" onclick="doVig()">ENCRYPT</button>
                        <div id="vR" class="result">Result: -</div>
                    </div>
                    <div class="algo-box">
                        <h3>Affine Cipher</h3>
                        <input id="aT" placeholder="Plaintext">
                        <input type="number" id="aA" placeholder="Key a (e.g. 5)">
                        <input type="number" id="aB" placeholder="Key b (e.g. 8)">
                        <button class="action-btn" onclick="doAff()">ENCRYPT</button>
                        <div id="aR" class="result">Result: -</div>
                    </div>`;
            } else if(n === 2) {
                content.innerHTML = `
                    <div class="algo-box" style="grid-column: 1/-1">
                        <h3>Playfair Cipher</h3>
                        <input id="pT" placeholder="Plaintext">
                        <input id="pK" placeholder="Key">
                        <button class="action-btn" onclick="doPF()">PROCESS</button>
                        <div id="pR" class="result">Result: -</div>
                    </div>`;
            } else if(n === 3) {
                content.innerHTML = `
                    <div class="algo-box">
                        <h3>Miller-Rabin</h3>
                        <input id="mI" type="number" placeholder="Enter number">
                        <button class="action-btn" onclick="doMR()">PRIME TEST</button>
                        <div id="mR" class="result">Result: -</div>
                    </div>
                    <div class="algo-box">
                        <h3>Euclidean GCD</h3>
                        <input id="gA" type="number" placeholder="Number A">
                        <input id="gB" type="number" placeholder="Number B">
                        <button class="action-btn" onclick="doGCD()">FIND GCD</button>
                        <div id="gR" class="result">Result: -</div>
                    </div>
                    <div class="algo-box">
                        <h3>Fermat Theorem</h3>
                        <p style="font-size:12px">a<sup>p-1</sup> ≡ 1 (mod p)</p>
                        <input id="fA" type="number" placeholder="Base (a)">
                        <input id="fP" type="number" placeholder="Prime (p)">
                        <button class="action-btn" onclick="doFermat()">VERIFY</button>
                        <div id="fRes" class="result">Result: -</div>
                    </div>`;
            }
        }

        function showHome() {
            document.getElementById('ex-container').style.display = 'none';
            document.getElementById('home-view').style.display = 'block';
        }

        // --- CRYPTO LOGIC ---
        function expMod(b, e, m) {
            let res = 1n; b = BigInt(b) % BigInt(m); e = BigInt(e);
            while (e > 0n) { if (e % 2n === 1n) res = (res * b) % BigInt(m); b = (b * b) % BigInt(m); e /= 2n; }
            return res;
        }

        function doVig() {
            let t = document.getElementById('vT').value.toUpperCase().replace(/[^A-Z]/g,''),
                k = document.getElementById('vK').value.toUpperCase().replace(/[^A-Z]/g,''), r = "";
            if(!k) return;
            for(let i=0, j=0; i<t.length; i++) {
                r += String.fromCharCode((t.charCodeAt(i)-65 + k.charCodeAt(j%k.length)-65)%26+65); j++;
            }
            document.getElementById('vR').innerText = "Output: " + r;
        }

        function doAff() {
            let t = document.getElementById('aT').value.toUpperCase().replace(/[^A-Z]/g,''),
                a = parseInt(document.getElementById('aA').value), b = parseInt(document.getElementById('aB').value), r = "";
            for(let i=0; i<t.length; i++) r += String.fromCharCode((a*(t.charCodeAt(i)-65)+b)%26+65);
            document.getElementById('aR').innerText = "Output: " + r;
        }

        function doPF() {
            let k = document.getElementById('pK').value.toUpperCase().replace(/J/g,'I').replace(/[^A-Z]/g,''),
                t = document.getElementById('pT').value.toUpperCase().replace(/J/g,'I').replace(/[^A-Z]/g,''),
                m = [], alpha = "ABCDEFGHIKLMNOPQRSTUVWXYZ", set = new Set(k + alpha), fK = Array.from(set);
            while(fK.length) m.push(fK.splice(0,5));
            let p = ""; for(let i=0; i<t.length; i++) { p += t[i]; if(t[i] === t[i+1]) p += 'X'; }
            if(p.length % 2 !== 0) p += 'X';
            let res = "";
            for(let i=0; i<p.length; i+=2) {
                let a=p[i], b=p[i+1], r1,c1,r2,c2;
                for(let r=0; r<5; r++) for(let c=0; c<5; c++) { if(m[r][c]===a){r1=r;c1=c} if(m[r][c]===b){r2=r;c2=c} }
                if(r1===r2) res += m[r1][(c1+1)%5]+m[r2][(c2+1)%5];
                else if(c1===c2) res += m[(r1+1)%5][c1]+m[(r2+1)%5][c2];
                else res += m[r1][c2]+m[r2][c1];
            }
            document.getElementById('pR').innerText = "Output: " + res;
        }

        function doMR() {
            let n = BigInt(document.getElementById('mI').value || 0);
            if(n < 2n) { document.getElementById('mR').innerText = "Neither"; return; }
            let d = n - 1n; while(d % 2n === 0n) d /= 2n;
            let x = expMod(2n, d, n);
            document.getElementById('mR').innerText = (x === 1n || x === n - 1n) ? "Probably Prime" : "Composite";
        }

        function doGCD() {
            let a = BigInt(document.getElementById('gA').value || 0), b = BigInt(document.getElementById('gB').value || 0);
            while(b !== 0n) { let t = b; b = a % b; a = t; }
            document.getElementById('gR').innerText = "GCD: " + a;
        }

        function doFermat() {
            let a = BigInt(document.getElementById('fA').value || 0), p = BigInt(document.getElementById('fP').value || 0);
            if(p < 2n) { document.getElementById('fRes').innerText = "P must be prime"; return; }
            let r = expMod(a, p - 1n, p);
            document.getElementById('fRes').innerText = "Result: " + r + (r === 1n ? " (Verified ✅)" : " (Fails ❌)");
        }
    </script>
</body>
</html>
